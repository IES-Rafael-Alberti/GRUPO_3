# Informe pentesting "La Descuidada S.A."

## Índice

- Resumen de la evaluación
- Índices de gravedad de los hallazgos
- Factores de riesgo
- Alcance
- Resumen ejecutivo
- Resumen e informe de vulnerabilidades
- Resultados técnicos del informe

---



Se ha realizó un test de intrusión sobre dos servidores Windows denominados `windows` (Windows Server 2008) y `windows2016` (Windows Server 2016), para identificar vulnerabilidades y proporcionar mitigaciones. Se han obtenido resultados, incluyendo ejecución remota de comandos y obtención de credenciales.

## Índices de gravedad de los hallazgos

## Factores de riesgo

## Alcance

| Hostname      | Sistema operativo         | IP         |
|---------------|---------------------------|------------|
| windows       | Windows Server 2008       | 10.0.2.8   |
| windows2016   | Windows Server 2016       | 10.0.2.11  |

## Resumen ejecutivo

### Windows Server 2016

En windows2016, se explotó con éxito la vulnerabilidad MS17-010 (EternalBlue), obteniendo acceso remoto con privilegios de sistema como administrador.

## Resumen e informe de vulnerabilidades

### Microsoft Windows Server 2008

Hemos realizado un análisis con Nessus para ver las vulnerabilidades que podia tener el equipo y una vez encontrada intentar la explotación de las esas vulnerabilidades. Del anterior escaneo nos ha encontrado 216 vulnerabilidades de las cuales 10 son criticas, 10 altas, 33 Medias, 5 bajas.

El reporte completo de Nessus se puede observar en l informe anexo en el primer hallazgo.

![alt text](img/Windows2008/image-4.png)

| Description of vulnerability | Ejecución remota de código a través de SMBv1 (MS17-010 + PsExec) |
|------------------------------|------------------------------------------------------------------------|
| **CVE/CWE**                  | [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144) / [CWE-787](https://cwe.mitre.org/data/definitions/787.html) |
| **CVSS v3**                  | 8.8 |
| **Severity**                 | Crítica |
| **Impact**                   | Permite a un atacante remoto ejecutar código a través de SMBv1 y subir una carga útil con privilegios de sistema. Se requiere acceso al recurso compartido `ADMIN$`. |
| **Affected systems**         | windows2016 |
| **Proof Of Concept (POC)**   | ![alt text](img/Windows2016/image-2.png) ![alt text](img/Windows2016/image-1.png) ![alt text](img/Windows2016/image-5.jpg)|
| **Remediation**              | Aplicar el parche MS17-010. Deshabilitar SMBv1 si no es necesario. Limitar el acceso a recursos compartidos. |
| **Reference links**          | [MS17-010 - Microsoft](https://learn.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010), [OWASP A06 2021](https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/) |

### Microsoft Windows Server 2016

Hemos realizado un análisis con nmap para saber que puertos tiene abierto y que servicios tiene abierto, después hemos realizado otro análisis con Nessus para ver que vulnerabilidades nos encontraba y depués hemos hecho otro con OpenVas para ver corroborar la información que nos había proporcionado Nessus.

![alt text](img/Windows2016/image-3.png)

![alt text](img/Windows2016/image-4.png)

| Description of vulnerability | Ejecución remota de código a través de SMBv1 (MS17-010 + PsExec) |
|------------------------------|------------------------------------------------------------------------|
| **CVE/CWE**                  | [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144) / [CWE-787](https://cwe.mitre.org/data/definitions/787.html) |
| **CVSS v3**                  | 8.8 |
| **Severity**                 | Crítica |
| **Impact**                   | Permite a un atacante remoto ejecutar código a través de SMBv1 y subir una carga útil con privilegios de sistema. Se requiere acceso al recurso compartido `ADMIN$`. |
| **Affected systems**         | windows2016 |
| **Proof Of Concept (POC)**   | ![alt text](img/Windows2016/image-2.png) ![alt text](img/Windows2016/image-1.png) ![alt text](img/Windows2016/image-5.jpg)|
| **Remediation**              | Aplicar el parche MS17-010. Deshabilitar SMBv1 si no es necesario. Limitar el acceso a recursos compartidos. |
| **Reference links**          | [MS17-010 - Microsoft](https://learn.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010), [OWASP A06 2021](https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/) |

## Resultados técnicos del informe

a

### Windows Server 2016 - Resultados

Se ha utilizamos Nessus y OpenVAS para identificar vulnerabilidades en el sistema. Ambos coincidieron en la presencia de la vulnerabilidad MS17-010 (EternalBlue), la cual fue explotada con éxito usando el módulo exploit/windows/smb/ms17_010_psexec de Metasploit.

Se obtuvo una sesión Meterpreter con privilegios de NT AUTHORITY\SYSTEM, lo que permitió acceder al sistema. También se ejecutó un dumpeo de hashes de los usuarios, lo que dió la existencia de contraseñas débiles. Se ha obtenido que el nombre del pc es `DC-COMPANY`
